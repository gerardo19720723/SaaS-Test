import{i as O,a as H,b as M,r as R,p as U,c as G,s as J}from"./index.JoXsz-Yp.js";import{l as K,j as z,p as Q,t as E,a as q,d as p,s as d,g as t,e as V,b as T,c as W,f as u,m,r as c,h as X,i as j,k as Y}from"./render.CO7qvLqz.js";import{i as Z}from"./proxy.0fAjzgfe.js";function B(e,i,o){if(e.multiple)return te(e,i);for(var r of e.options){var a=_(r);if(Z(a,i)){r.selected=!0;return}}(!o||i!==void 0)&&(e.selectedIndex=-1)}function ee(e,i){z(()=>{var o=new MutationObserver(()=>{var r=e.__value;B(e,r)});return o.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{o.disconnect()}})}function ae(e,i,o=i){var r=!0;K(e,"change",()=>{var a;if(e.multiple)a=[].map.call(e.querySelectorAll(":checked"),_);else{var l=e.querySelector(":checked");a=l&&_(l)}o(a)}),z(()=>{var a=i();if(B(e,a,r),r&&a===void 0){var l=e.querySelector(":checked");l!==null&&(a=_(l),o(a))}e.__value=a,r=!1}),ee(e)}function te(e,i){for(var o of e.options)o.selected=~i.indexOf(_(o))}function _(e){return"__value"in e?e.__value:e.value}var oe=E("<p> </p>"),re=E('<div class="p-6 bg-white rounded-lg shadow-lg max-w-md mx-auto mt-8"><h2 class="text-2xl font-bold mb-4">Crear Pago</h2> <!> <form class="space-y-4"><div><label for="amount" class="block text-sm font-medium mb-2">Monto (ARS)</label> <input id="amount" type="number" min="1" class="w-full p-2 border rounded" required></div> <div><label for="provider" class="block text-sm font-medium mb-2">Pasarela de Pago</label> <select id="provider" class="w-full p-2 border rounded"><option>Stripe</option><option>Mercado Pago</option><option>Todo Pago</option></select></div> <div><label for="description" class="block text-sm font-medium mb-2">Descripci√≥n</label> <input id="description" type="text" class="w-full p-2 border rounded" required></div> <button type="submit" class="w-full bg-green-500 text-white p-2 rounded hover:bg-green-600 disabled:opacity-50"> </button></form></div>');function le(e,i){Q(i,!1);let o=m(1e3),r=m("stripe"),a=m("Suscripci√≥n mensual"),l=m(!1),v=m("");const A="http://localhost:3002/api";async function F(){u(l,!0),u(v,"");const n=localStorage.getItem("token");if(console.log("üîë Token encontrado:",n),console.log("üìß Datos del pago:",{amount:t(o),provider:t(r),description:t(a)}),!n){u(v,"‚ùå No hay token - debes iniciar sesi√≥n"),u(l,!1);return}try{console.log("üöÄ Enviando a:",`${A}/payments/create`),console.log("üìã Headers:",{Authorization:`Bearer ${n}`,"Content-Type":"application/json"});const s=await G.post(`${A}/payments/create`,{amount:parseInt(t(o)),currency:"ARS",provider:t(r),description:t(a)},{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});console.log("‚úÖ Respuesta pago:",s.data),u(v,"‚úÖ Pago creado exitosamente")}catch(s){console.log("‚ùå Error completo:",s),console.log("‚ùå Status:",s.response?.status),console.log("‚ùå Data:",s.response?.data);let f="Error desconocido";s.response?.status===401?f="‚ùå No autorizado - token inv√°lido o expirado":s.response?.status===403?f="‚ùå Prohibido - sin permisos":s.response?.data?.error&&(f=s.response.data.error),u(v,f)}finally{u(l,!1)}}O();var b=re(),$=d(p(b),2);H($,()=>t(v),n=>{var s=oe();const f=X(()=>`mb-4 text-center ${(t(v).includes("‚ùå")?"text-red-600":"text-green-600")??""}`);var N=p(s,!0);c(s),q(()=>{J(s,t(f)),j(N,t(v))}),T(n,s)});var g=d($,2),h=p(g),C=d(p(h),2);R(C),c(h);var x=d(h,2),y=d(p(x),2);q(()=>{t(r),Y(()=>{})});var k=p(y);k.value=(k.__value="stripe")==null?"":"stripe";var P=d(k);P.value=(P.__value="mercadopago")==null?"":"mercadopago";var D=d(P);D.value=(D.__value="todopago")==null?"":"todopago",c(y),c(x);var w=d(x,2),I=d(p(w),2);R(I),c(w);var S=d(w,2),L=p(S,!0);c(S),c(g),c(b),q(()=>{S.disabled=t(l),j(L,t(l)?"Procesando...":"Crear Pago")}),M(C,()=>t(o),n=>u(o,n)),ae(y,()=>t(r),n=>u(r,n)),M(I,()=>t(a),n=>u(a,n)),V("submit",g,U(F)),T(e,b),W()}export{le as default};
